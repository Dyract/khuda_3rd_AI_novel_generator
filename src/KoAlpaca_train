{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"https://gist.github.com/Beomi/a3032e4eaa33b86fdf8de1f47f15a647#file-2023_05_26_bnb_4bit_koalpaca_v1_1a_on_polyglot_ko_12_8b-ipynb","timestamp":1689991444963}],"gpuType":"T4","machine_shape":"hm"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"e7427becfaef41beab4f0a75f3e4e974":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f03a4a54218f4bffa608acdff77e8b5e","IPY_MODEL_75217ce075884a32bed668503c490096","IPY_MODEL_927d8dc9f97c4c61829329380910160b"],"layout":"IPY_MODEL_8af02ee836e44c73b72824ba0c09821e"}},"f03a4a54218f4bffa608acdff77e8b5e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_170056f30b4d4037bc0b53f7ba80b4a2","placeholder":"​","style":"IPY_MODEL_d5856817d5a64e3c92fc4edb59db751d","value":"Downloading data files: 100%"}},"75217ce075884a32bed668503c490096":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_071fe2036d0c4a8d9250570cf17f98bc","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e1a301dcff354f32aeb8217ccd9b480a","value":1}},"927d8dc9f97c4c61829329380910160b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b1f8710fdcf04c7fbaf2e7910e18a228","placeholder":"​","style":"IPY_MODEL_6fa90f84c294459aa46b93358d81d277","value":" 1/1 [00:00&lt;00:00, 60.41it/s]"}},"8af02ee836e44c73b72824ba0c09821e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"170056f30b4d4037bc0b53f7ba80b4a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d5856817d5a64e3c92fc4edb59db751d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"071fe2036d0c4a8d9250570cf17f98bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e1a301dcff354f32aeb8217ccd9b480a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b1f8710fdcf04c7fbaf2e7910e18a228":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6fa90f84c294459aa46b93358d81d277":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7530fbd43de6429abe22cdf1a92f98f8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_7a5ea62f37cc424b86cb718c034a18fe","IPY_MODEL_7e4a38c293ca4acea56aa1048e514636","IPY_MODEL_7ea767bed3134d9ca697963be4195c51"],"layout":"IPY_MODEL_0fed8f50945c4831ab4ed188d3db8b1a"}},"7a5ea62f37cc424b86cb718c034a18fe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1018e58ba6e34d5f82a667cd77d6cff9","placeholder":"​","style":"IPY_MODEL_764a6f58b35849b4aecfe48196777810","value":"Extracting data files: 100%"}},"7e4a38c293ca4acea56aa1048e514636":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d8d076563d60442e8b467e4bf4fa8ea1","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f16295d1bfc7417cb9600856dd1e9925","value":1}},"7ea767bed3134d9ca697963be4195c51":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bdf04908fbd342939d5020d27bf0b8c2","placeholder":"​","style":"IPY_MODEL_21daaed24c6a432799ca790bc2a1ac14","value":" 1/1 [00:01&lt;00:00,  1.23s/it]"}},"0fed8f50945c4831ab4ed188d3db8b1a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1018e58ba6e34d5f82a667cd77d6cff9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"764a6f58b35849b4aecfe48196777810":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d8d076563d60442e8b467e4bf4fa8ea1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f16295d1bfc7417cb9600856dd1e9925":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bdf04908fbd342939d5020d27bf0b8c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"21daaed24c6a432799ca790bc2a1ac14":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"47e8945682c6460f9c8f13dc68d2f35e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5f1330787c33431e8a821b34a7925c73","IPY_MODEL_e5f38985c82044b2b05520f3e74b0f92","IPY_MODEL_5206db98e19240b29586a0819d1d0ac0"],"layout":"IPY_MODEL_82e3b92eae8047229fd702f9ab94ad46"}},"5f1330787c33431e8a821b34a7925c73":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_13db171f76c04e47b10427ae9d6168a4","placeholder":"​","style":"IPY_MODEL_d3e06ee4852e42f38fd9f40f9b28c2c4","value":"Generating train split: "}},"e5f38985c82044b2b05520f3e74b0f92":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"info","description":"","description_tooltip":null,"layout":"IPY_MODEL_c9ec6b526d95455b8bf894c8806a05eb","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7b7aa41eb03b4b918803750370d6a3db","value":1}},"5206db98e19240b29586a0819d1d0ac0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_93f2565785854384b284ed93ed988fff","placeholder":"​","style":"IPY_MODEL_dfe621b089b04a43bff1542c3e1b7c35","value":" 8286/0 [00:00&lt;00:00, 14602.44 examples/s]"}},"82e3b92eae8047229fd702f9ab94ad46":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"13db171f76c04e47b10427ae9d6168a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d3e06ee4852e42f38fd9f40f9b28c2c4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c9ec6b526d95455b8bf894c8806a05eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"7b7aa41eb03b4b918803750370d6a3db":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"93f2565785854384b284ed93ed988fff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dfe621b089b04a43bff1542c3e1b7c35":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3c05badd67bc4b89aeeece48e7b97f73":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_196d870297e5464ba52447ee0ea9cdb7","IPY_MODEL_bcb9867cd11f4480b39fab1c0dfe53a1","IPY_MODEL_be37e0c9e2d94420b16d16d3655d07cc"],"layout":"IPY_MODEL_dc7945d7e6ee4d579728578c609047b2"}},"196d870297e5464ba52447ee0ea9cdb7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c39550dc953742debc9c448ee373935d","placeholder":"​","style":"IPY_MODEL_10cf721f6b00418f865c527b209fe20b","value":"Map:  88%"}},"bcb9867cd11f4480b39fab1c0dfe53a1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_eb8e202cfbe3473e9bf50b90adece3d3","max":7043,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3fd5a8caaa734bedbaa99485ee1cf849","value":7043}},"be37e0c9e2d94420b16d16d3655d07cc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0347b325317044edbe65f1b4ec5f05f1","placeholder":"​","style":"IPY_MODEL_629eadcf90c545eabf2576bf06062b69","value":" 6188/7043 [00:00&lt;00:00, 10060.32 examples/s]"}},"dc7945d7e6ee4d579728578c609047b2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"c39550dc953742debc9c448ee373935d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10cf721f6b00418f865c527b209fe20b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"eb8e202cfbe3473e9bf50b90adece3d3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3fd5a8caaa734bedbaa99485ee1cf849":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0347b325317044edbe65f1b4ec5f05f1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"629eadcf90c545eabf2576bf06062b69":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b532b223f19b42b08e3bfa9a7120b592":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d302a0d15d52441380aab6eba3a30754","IPY_MODEL_0dfb5df415ca4263bdaa917e63b49509","IPY_MODEL_5ade397c3e3644bfb96c5c6665e8810a"],"layout":"IPY_MODEL_61fabe0b2c3849fd9f5e2d87927fd029"}},"d302a0d15d52441380aab6eba3a30754":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ef66d8e5b9bd42d790ee87ab35a990f6","placeholder":"​","style":"IPY_MODEL_f2639e28e28c466885c09977a95663be","value":"Map:  85%"}},"0dfb5df415ca4263bdaa917e63b49509":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_e9ad11a150ea44188c228920f1283453","max":1243,"min":0,"orientation":"horizontal","style":"IPY_MODEL_acb9acbd785343de90a73ba03fe57924","value":1243}},"5ade397c3e3644bfb96c5c6665e8810a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_236963d0ba9b4be59c6edced6a554bda","placeholder":"​","style":"IPY_MODEL_ef176757f6934333a9aab7fd6bd48a6d","value":" 1056/1243 [00:00&lt;00:00, 9494.79 examples/s]"}},"61fabe0b2c3849fd9f5e2d87927fd029":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"ef66d8e5b9bd42d790ee87ab35a990f6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f2639e28e28c466885c09977a95663be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e9ad11a150ea44188c228920f1283453":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"acb9acbd785343de90a73ba03fe57924":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"236963d0ba9b4be59c6edced6a554bda":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ef176757f6934333a9aab7fd6bd48a6d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b000964eb655490fa4d11c0728109cfb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_c534c5dde77d44b7a1cd0ccf497fe067","IPY_MODEL_228b0c9ee7c743c7af967a97e3775ff3","IPY_MODEL_fb1c1dd20c2e4297ac4e0cbb91ce8537"],"layout":"IPY_MODEL_f604f8b3cd984c4f9018f7060d1c7655"}},"c534c5dde77d44b7a1cd0ccf497fe067":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00b19d59362b4b5dae68af6ca880043f","placeholder":"​","style":"IPY_MODEL_71b0b08b38b64036839f75c5adda5ecc","value":"Map:  80%"}},"228b0c9ee7c743c7af967a97e3775ff3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_d876d562609e45ebb131d71d126bdcc4","max":1243,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7cc377156e6244f78679fc42c6280e17","value":1243}},"fb1c1dd20c2e4297ac4e0cbb91ce8537":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c18982f851a24726a2658c97134f6a59","placeholder":"​","style":"IPY_MODEL_930d747e7c894665a01adb75915d4365","value":" 1000/1243 [00:00&lt;00:00, 9074.63 examples/s]"}},"f604f8b3cd984c4f9018f7060d1c7655":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"00b19d59362b4b5dae68af6ca880043f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"71b0b08b38b64036839f75c5adda5ecc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d876d562609e45ebb131d71d126bdcc4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7cc377156e6244f78679fc42c6280e17":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c18982f851a24726a2658c97134f6a59":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"930d747e7c894665a01adb75915d4365":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# 4bit quantization으로 Polyglot-ko 12.8B QLoRA 학습하기\n","\n","- Colab Free (T4 GPU)에서, 한국어 언어 모델 중 가장 큰 크기 모델인 Polyglot-ko 12.8B 모델을 QLoRA로 파인튜닝 해 봅시다."],"metadata":{"id":"XIyP_0r6zuVc"}},{"cell_type":"code","source":["!nvidia-smi"],"metadata":{"id":"CHX-RCPdkXgP","outputId":"4df44b81-0ec4-4f1e-c828-5264883b248f","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1690169872745,"user_tz":-540,"elapsed":43,"user":{"displayName":"박민아","userId":"17348247684003147157"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mon Jul 24 03:37:51 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.105.17   Driver Version: 525.105.17   CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  NVIDIA A100-SXM...  Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   32C    P0    41W / 400W |      0MiB / 40960MiB |      0%      Default |\n","|                               |                      |             Disabled |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eaiS8AonyyTi","executionInfo":{"status":"ok","timestamp":1690169899223,"user_tz":-540,"elapsed":26513,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"outputId":"64e03500-9bc4-44ec-b177-91a35cbeb675"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FuXIFTFapAMI","colab":{"base_uri":"https://localhost:8080/"},"outputId":"391ba6ad-2399-45ea-d6c2-2ed5ad33c7b1","executionInfo":{"status":"ok","timestamp":1690169961151,"user_tz":-540,"elapsed":61954,"user":{"displayName":"박민아","userId":"17348247684003147157"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m92.6/92.6 MB\u001b[0m \u001b[31m20.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m6.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m107.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m76.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Building wheel for transformers (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m244.2/244.2 kB\u001b[0m \u001b[31m5.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Building wheel for peft (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for accelerate (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m486.2/486.2 kB\u001b[0m \u001b[31m7.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m8.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m10.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m10.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m11.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}],"source":["!pip install -q -U bitsandbytes\n","!pip install -q -U git+https://github.com/huggingface/transformers.git\n","!pip install -q -U git+https://github.com/huggingface/peft.git\n","!pip install -q -U git+https://github.com/huggingface/accelerate.git\n","!pip install -q datasets"]},{"cell_type":"code","source":["from datasets import load_dataset\n","\n","#data = load_dataset(\"beomi/KoAlpaca-v1.1a\")"],"metadata":{"id":"jm4FzCvfeYcK"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["```\n","import pandas as pd\n","\n","# Replace 'your_file.csv' with the actual file path of your CSV file\n","file_path = '/content/ununited_output.csv'\n","df = pd.read_csv(file_path)\n","\n","# Drop rows where either 'Column1' or 'Column2' has NaN or empty value\n","df.dropna(subset=['input', 'output'], how='any', inplace=True)\n","df.reset_index(drop=True, inplace=True)\n","\n","print(df)\n","output_file_path = 'revised_file.csv'\n","# Save the revised DataFrame to a new CSV file\n","df.to_csv(output_file_path, index=False)\n","```"],"metadata":{"id":"fPH-WNL7F-SI"}},{"cell_type":"code","source":["output_csv_file = '/content/drive/MyDrive/쿠다 소설 생성/data/csv/combined2_text.csv'\n","squad = (load_dataset(\"csv\", data_files=output_csv_file, split='train')\n","        .train_test_split(test_size=0.15))\n","\n","#squad = (load_dataset(\"csv\", data_files=output_csv_file, split='train')\n","#        .train_test_split(test_size=0.15))\n","\n","dataset = squad\n","#dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":136,"referenced_widgets":["e7427becfaef41beab4f0a75f3e4e974","f03a4a54218f4bffa608acdff77e8b5e","75217ce075884a32bed668503c490096","927d8dc9f97c4c61829329380910160b","8af02ee836e44c73b72824ba0c09821e","170056f30b4d4037bc0b53f7ba80b4a2","d5856817d5a64e3c92fc4edb59db751d","071fe2036d0c4a8d9250570cf17f98bc","e1a301dcff354f32aeb8217ccd9b480a","b1f8710fdcf04c7fbaf2e7910e18a228","6fa90f84c294459aa46b93358d81d277","7530fbd43de6429abe22cdf1a92f98f8","7a5ea62f37cc424b86cb718c034a18fe","7e4a38c293ca4acea56aa1048e514636","7ea767bed3134d9ca697963be4195c51","0fed8f50945c4831ab4ed188d3db8b1a","1018e58ba6e34d5f82a667cd77d6cff9","764a6f58b35849b4aecfe48196777810","d8d076563d60442e8b467e4bf4fa8ea1","f16295d1bfc7417cb9600856dd1e9925","bdf04908fbd342939d5020d27bf0b8c2","21daaed24c6a432799ca790bc2a1ac14","47e8945682c6460f9c8f13dc68d2f35e","5f1330787c33431e8a821b34a7925c73","e5f38985c82044b2b05520f3e74b0f92","5206db98e19240b29586a0819d1d0ac0","82e3b92eae8047229fd702f9ab94ad46","13db171f76c04e47b10427ae9d6168a4","d3e06ee4852e42f38fd9f40f9b28c2c4","c9ec6b526d95455b8bf894c8806a05eb","7b7aa41eb03b4b918803750370d6a3db","93f2565785854384b284ed93ed988fff","dfe621b089b04a43bff1542c3e1b7c35"]},"id":"HGzGN7iRba0R","executionInfo":{"status":"ok","timestamp":1690169965838,"user_tz":-540,"elapsed":4112,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"outputId":"47b1ec3f-fa16-433d-ee82-1c8b04cd6224"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset csv/default to /root/.cache/huggingface/datasets/csv/default-ba3e811c63c7a19e/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e7427becfaef41beab4f0a75f3e4e974"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7530fbd43de6429abe22cdf1a92f98f8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split: 0 examples [00:00, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"47e8945682c6460f9c8f13dc68d2f35e"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset csv downloaded and prepared to /root/.cache/huggingface/datasets/csv/default-ba3e811c63c7a19e/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d. Subsequent calls will reuse this data.\n"]}]},{"cell_type":"code","source":["data = dataset.map(\n","    lambda x: {'text': f\"### 질문:'다음 문장을 이어쓰시오. \\n\\n###맥락 : {x['input']}\\n\\n### 답변: {x['output']}<|endoftext|>\"}\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":17,"referenced_widgets":["3c05badd67bc4b89aeeece48e7b97f73","196d870297e5464ba52447ee0ea9cdb7","bcb9867cd11f4480b39fab1c0dfe53a1","be37e0c9e2d94420b16d16d3655d07cc","dc7945d7e6ee4d579728578c609047b2","c39550dc953742debc9c448ee373935d","10cf721f6b00418f865c527b209fe20b","eb8e202cfbe3473e9bf50b90adece3d3","3fd5a8caaa734bedbaa99485ee1cf849","0347b325317044edbe65f1b4ec5f05f1","629eadcf90c545eabf2576bf06062b69","b532b223f19b42b08e3bfa9a7120b592","d302a0d15d52441380aab6eba3a30754","0dfb5df415ca4263bdaa917e63b49509","5ade397c3e3644bfb96c5c6665e8810a","61fabe0b2c3849fd9f5e2d87927fd029","ef66d8e5b9bd42d790ee87ab35a990f6","f2639e28e28c466885c09977a95663be","e9ad11a150ea44188c228920f1283453","acb9acbd785343de90a73ba03fe57924","236963d0ba9b4be59c6edced6a554bda","ef176757f6934333a9aab7fd6bd48a6d"]},"id":"Ci6NiGPgcH3g","executionInfo":{"status":"ok","timestamp":1690169966434,"user_tz":-540,"elapsed":634,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"outputId":"05ed4f4b-9544-4173-d8e2-a2c5f61851ae"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/7043 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3c05badd67bc4b89aeeece48e7b97f73"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/1243 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b532b223f19b42b08e3bfa9a7120b592"}},"metadata":{}}]},{"cell_type":"markdown","source":["## 데이터셋: KoAlpaca v1.1a"],"metadata":{"id":"MJ-5idQwzvg-"}},{"cell_type":"code","source":["data"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2KUhV7x3e6Db","outputId":"8a8fa987-1782-40ec-d663-7375914de159","executionInfo":{"status":"ok","timestamp":1690169966435,"user_tz":-540,"elapsed":29,"user":{"displayName":"박민아","userId":"17348247684003147157"}}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['input', 'output', 'text'],\n","        num_rows: 7043\n","    })\n","    test: Dataset({\n","        features: ['input', 'output', 'text'],\n","        num_rows: 1243\n","    })\n","})"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["# # data\n","# data = data.map(\n","#     lambda x:\n","#     {'text': f\"### 명령어: {x['instruction']}\\n\\n###맥락: {x['input']}\\n\\n### 답변: {x['output']}<|endoftext|>\" }\n","#     if x['input'] else\n","#     {'text':f\"### 명령어: {x['instruction']}\\n\\n### 답변: {x['output']}<|endoftext|>\"},\n","# )\n","# data\n","#data = data.map(\n","#    lambda x: {'text': f\"### 질문: {x['instruction']}\\n\\n### 답변: {x['output']}<|endoftext|>\" }\n","#)"],"metadata":{"id":"0FbgsI9sezTJ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 쪼개진 모델 로드\n","\n","- 원래는 단일 파일이기도 하지만, 작은 파일(약 1GB)로 쪼개서 개별로 로드한 레포를 쓰면 RAM이 터지지 않습니다."],"metadata":{"id":"jPDIKV6aBCCa"}},{"cell_type":"code","source":["import torch\n","from transformers import AutoTokenizer, AutoModelForCausalLM, BitsAndBytesConfig\n","\n","#model_id = \"beomi/polyglot-ko-12.8b-safetensors\"  # safetensors 컨버팅된 레포\n","#model_id = \"/content/drive/MyDrive/checkpoints_2/checkpoint-1400\"\n","model_id = \"/content/drive/MyDrive/checkpoint-100\"\n","\n","bnb_config = BitsAndBytesConfig(\n","    load_in_4bit=True,\n","    bnb_4bit_use_double_quant=True,\n","    bnb_4bit_quant_type=\"nf4\",\n","    bnb_4bit_compute_dtype=torch.bfloat16\n",")\n","\n","tokenizer = AutoTokenizer.from_pretrained(model_id)\n","model = AutoModelForCausalLM.from_pretrained(model_id, quantization_config=bnb_config, device_map={\"\":0})"],"metadata":{"id":"E0Nl5mWL0k2T","colab":{"base_uri":"https://localhost:8080/","height":435},"executionInfo":{"status":"error","timestamp":1690186852277,"user_tz":-540,"elapsed":458,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"outputId":"d01f21be-7d75-4e63-feb0-6b08feb1e31b"},"execution_count":null,"outputs":[{"output_type":"error","ename":"OSError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mOSError\u001b[0m                                   Traceback (most recent call last)","\u001b[0;32m<ipython-input-38-3e51c2f33194>\u001b[0m in \u001b[0;36m<cell line: 15>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     13\u001b[0m )\n\u001b[1;32m     14\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 15\u001b[0;31m \u001b[0mtokenizer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mAutoTokenizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_pretrained\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_id\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     16\u001b[0m \u001b[0mmodel\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mAutoModelForCausalLM\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfrom_pretrained\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_id\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mquantization_config\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbnb_config\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdevice_map\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m\"\"\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/models/auto/tokenization_auto.py\u001b[0m in \u001b[0;36mfrom_pretrained\u001b[0;34m(cls, pretrained_model_name_or_path, *inputs, **kwargs)\u001b[0m\n\u001b[1;32m    665\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mconfig_tokenizer_class\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    666\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mconfig\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mPretrainedConfig\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 667\u001b[0;31m                 config = AutoConfig.from_pretrained(\n\u001b[0m\u001b[1;32m    668\u001b[0m                     \u001b[0mpretrained_model_name_or_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrust_remote_code\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtrust_remote_code\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    669\u001b[0m                 )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/models/auto/configuration_auto.py\u001b[0m in \u001b[0;36mfrom_pretrained\u001b[0;34m(cls, pretrained_model_name_or_path, **kwargs)\u001b[0m\n\u001b[1;32m    985\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"name_or_path\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpretrained_model_name_or_path\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    986\u001b[0m         \u001b[0mtrust_remote_code\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"trust_remote_code\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 987\u001b[0;31m         \u001b[0mconfig_dict\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0munused_kwargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mPretrainedConfig\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_config_dict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpretrained_model_name_or_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    988\u001b[0m         \u001b[0mhas_remote_code\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m\"auto_map\"\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mconfig_dict\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;34m\"AutoConfig\"\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mconfig_dict\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"auto_map\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    989\u001b[0m         \u001b[0mhas_local_code\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m\"model_type\"\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mconfig_dict\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mconfig_dict\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"model_type\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mCONFIG_MAPPING\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/configuration_utils.py\u001b[0m in \u001b[0;36mget_config_dict\u001b[0;34m(cls, pretrained_model_name_or_path, **kwargs)\u001b[0m\n\u001b[1;32m    615\u001b[0m         \u001b[0moriginal_kwargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcopy\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdeepcopy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    616\u001b[0m         \u001b[0;31m# Get config dict associated with the base config file\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 617\u001b[0;31m         \u001b[0mconfig_dict\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkwargs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcls\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_get_config_dict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpretrained_model_name_or_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    618\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;34m\"_commit_hash\"\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mconfig_dict\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    619\u001b[0m             \u001b[0moriginal_kwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"_commit_hash\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mconfig_dict\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"_commit_hash\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/configuration_utils.py\u001b[0m in \u001b[0;36m_get_config_dict\u001b[0;34m(cls, pretrained_model_name_or_path, **kwargs)\u001b[0m\n\u001b[1;32m    670\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    671\u001b[0m                 \u001b[0;31m# Load from local folder or from cache or download from model Hub and cache\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 672\u001b[0;31m                 resolved_config_file = cached_file(\n\u001b[0m\u001b[1;32m    673\u001b[0m                     \u001b[0mpretrained_model_name_or_path\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    674\u001b[0m                     \u001b[0mconfiguration_file\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/utils/hub.py\u001b[0m in \u001b[0;36mcached_file\u001b[0;34m(path_or_repo_id, filename, cache_dir, force_download, resume_download, proxies, use_auth_token, revision, local_files_only, subfolder, repo_type, user_agent, _raise_exceptions_for_missing_entries, _raise_exceptions_for_connection_errors, _commit_hash)\u001b[0m\n\u001b[1;32m    386\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0misfile\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresolved_file\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    387\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0m_raise_exceptions_for_missing_entries\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 388\u001b[0;31m                 raise EnvironmentError(\n\u001b[0m\u001b[1;32m    389\u001b[0m                     \u001b[0;34mf\"{path_or_repo_id} does not appear to have a file named {full_filename}. Checkout \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    390\u001b[0m                     \u001b[0;34mf\"'https://huggingface.co/{path_or_repo_id}/{revision}' for available files.\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mOSError\u001b[0m: /content/drive/MyDrive/checkpoint-100 does not appear to have a file named config.json. Checkout 'https://huggingface.co//content/drive/MyDrive/checkpoint-100/None' for available files."]}]},{"cell_type":"markdown","source":["## 텍스트 데이터만 tokenize"],"metadata":{"id":"xen1VQe-A_YD"}},{"cell_type":"code","source":["#data = data.map(lambda samples: tokenizer(samples[\"text\"]), batched=True)\n","\n","def tokenize_function(example):\n","    return tokenizer(example[\"text\"], truncation=True)\n","\n","tokenized_datasets = data.map(tokenize_function, batched=True)\n","tokenized_datasets"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":280,"referenced_widgets":["b000964eb655490fa4d11c0728109cfb","c534c5dde77d44b7a1cd0ccf497fe067","228b0c9ee7c743c7af967a97e3775ff3","fb1c1dd20c2e4297ac4e0cbb91ce8537","f604f8b3cd984c4f9018f7060d1c7655","00b19d59362b4b5dae68af6ca880043f","71b0b08b38b64036839f75c5adda5ecc","d876d562609e45ebb131d71d126bdcc4","7cc377156e6244f78679fc42c6280e17","c18982f851a24726a2658c97134f6a59","930d747e7c894665a01adb75915d4365"]},"id":"B0VnTkgHtbAS","executionInfo":{"status":"ok","timestamp":1690171567028,"user_tz":-540,"elapsed":621,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"outputId":"877667a3-d54f-43cf-eb71-2ed6190e57d5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:datasets.arrow_dataset:Loading cached processed dataset at /root/.cache/huggingface/datasets/csv/default-ba3e811c63c7a19e/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-b2229b0e19cda448.arrow\n"]},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/1243 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b000964eb655490fa4d11c0728109cfb"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.\n"]},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['input', 'output', 'text', 'input_ids', 'token_type_ids', 'attention_mask'],\n","        num_rows: 7043\n","    })\n","    test: Dataset({\n","        features: ['input', 'output', 'text', 'input_ids', 'token_type_ids', 'attention_mask'],\n","        num_rows: 1243\n","    })\n","})"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["tokenized_datasets['train'][-1]['text']"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":87},"id":"h61VdWpSAJEp","outputId":"20c73a60-191b-4609-8142-22cb2e5d3e20","executionInfo":{"status":"ok","timestamp":1690171567029,"user_tz":-540,"elapsed":24,"user":{"displayName":"박민아","userId":"17348247684003147157"}}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'### 질문:\\'다음 문장을 이어쓰시오. \\n\\n###맥락 : \"밤에 조용히 내부 관사로 와서 저도 있을 테니까. 그리고 네 논이 두 개의 논인 거겠군요.\"\\n\\n### 답변: 두려움에 떨면서 더펄이는 급하게 그 돌을 집어들고 눈을 돌린다. 마구잡이로 가볍게 주먹을 휘둘렀다. 막상 들어있는 금을 보자 얼마든지 팔 수 있을 것 같다는 생각이 들어 그는 즐거워서 흥겨운 춤을 추기 시작한다.<|endoftext|>'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":20}]},{"cell_type":"markdown","source":["PEFT를 통해 `prepare_model_for_kbit_training`로 Low bit 학습을 준비해줍시다."],"metadata":{"id":"Mp2gMi1ZzGET"}},{"cell_type":"code","source":["from peft import prepare_model_for_kbit_training\n","\n","model.gradient_checkpointing_enable()\n","model = prepare_model_for_kbit_training(model)"],"metadata":{"id":"a9EUEDAl0ss3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def print_trainable_parameters(model):\n","    \"\"\"\n","    Prints the number of trainable parameters in the model.\n","    \"\"\"\n","    trainable_params = 0\n","    all_param = 0\n","    for _, param in model.named_parameters():\n","        all_param += param.numel()\n","        if param.requires_grad:\n","            trainable_params += param.numel()\n","    print(\n","        f\"trainable params: {trainable_params} || all params: {all_param} || trainable%: {100 * trainable_params / all_param}\"\n","    )"],"metadata":{"id":"gkIcwsSU01EB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from peft import LoraConfig, get_peft_model\n","\n","config = LoraConfig(\n","    r=8,\n","    lora_alpha=32,\n","    target_modules=[\"query_key_value\"],\n","    lora_dropout=0.05,\n","    bias=\"none\",\n","    task_type=\"CAUSAL_LM\"\n",")\n","\n","model = get_peft_model(model, config)\n","print_trainable_parameters(model)"],"metadata":{"id":"Ybeyl20n3dYH","colab":{"base_uri":"https://localhost:8080/"},"outputId":"77549c13-448a-4cc4-d2fb-79593dcb2e35","executionInfo":{"status":"ok","timestamp":1690171591521,"user_tz":-540,"elapsed":24511,"user":{"displayName":"박민아","userId":"17348247684003147157"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["trainable params: 6553600 || all params: 6608701440 || trainable%: 0.09916622894073424\n"]}]},{"cell_type":"code","source":["# !nvidia-smi"],"metadata":{"id":"s6f4z8EYmcJ6"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 학습하기!\n","\n","- 이번 예제에서는 22k개의 아주아주 일부분인 100개 스텝만 학습해봅시다."],"metadata":{"id":"_0MOtwf3zdZp"}},{"cell_type":"markdown","source":["```\n","import transformers\n","import gc\n","import torch\n","\n","#gc.collect()\n","#torch.cuda.empty_cache()\n","\n","# needed for gpt-neo-x tokenizer\n","tokenizer.pad_token = tokenizer.eos_token\n","\n","trainer = transformers.Trainer(\n","    model=model,\n","    train_dataset=tokenized_datasets[\"train\"],\n","    args=transformers.TrainingArguments(\n","        per_device_train_batch_size=1,\n","        gradient_accumulation_steps=1,\n","        max_steps=50, ## 초소량만 학습: 50 step만 학습. 약 4분정도 걸립니다.\n","        learning_rate=1e-4,\n","        fp16=True,\n","        logging_steps=10,\n","        output_dir=\"outputs\",\n","        optim=\"paged_adamw_8bit\",\n","        #remove_unused_columns=False\n","    ),\n","    data_collator=transformers.DataCollatorForLanguageModeling(tokenizer, mlm=False),\n","    # data_collator=transformers.DataCollatorWithPadding(tokenizer=tokenizer),\n",")\n","model.config.use_cache = False  # silence the warnings. Please re-enable for inference!\n","trainer.train()\n","```"],"metadata":{"id":"gqE88yKOmGe6"}},{"cell_type":"code","source":["import transformers\n","\n","# needed for gpt-neo-x tokenizer\n","tokenizer.pad_token = tokenizer.eos_token\n","\n","trainer = transformers.Trainer(\n","    model=model,\n","    train_dataset=tokenized_datasets[\"train\"],\n","    eval_dataset=tokenized_datasets[\"test\"],\n","    args=transformers.TrainingArguments(\n","        per_device_train_batch_size=2,\n","        gradient_accumulation_steps=1,\n","        num_train_epochs = 2,\n","        #learning_rate=1e-4,\n","        learning_rate=1e-5,\n","        fp16=True,\n","        save_strategy=\"steps\",\n","        evaluation_strategy=\"steps\",\n","        logging_steps=10,\n","        save_steps = 300,\n","        #load_best_model_at_end=True,\n","        output_dir=\"/content/drive/MyDrive/쿠다 소설 생성/checkpoints_2/\",\n","        optim=\"paged_adamw_8bit\"\n","    ),\n","    data_collator=transformers.DataCollatorForLanguageModeling(tokenizer, mlm=False),\n",")\n","model.config.use_cache = False  # silence the warnings. Please re-enable for inference!\n","trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"cf24nrk-mE3M","executionInfo":{"status":"error","timestamp":1690184319483,"user_tz":-540,"elapsed":5011095,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"outputId":"5538bcef-3654-4b21-b608-f996c759961b"},"execution_count":null,"outputs":[{"metadata":{"tags":null},"name":"stderr","output_type":"stream","text":["You're using a PreTrainedTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.\n"]},{"data":{"text/html":["\n","    <div>\n","      \n","      <progress value='871' max='7044' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [ 871/7044 2:07:41 < 15:07:03, 0.11 it/s, Epoch 0.25/2]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>10</td>\n","      <td>4.424000</td>\n","      <td>4.244807</td>\n","    </tr>\n","    <tr>\n","      <td>20</td>\n","      <td>4.359800</td>\n","      <td>4.178282</td>\n","    </tr>\n","    <tr>\n","      <td>30</td>\n","      <td>4.510600</td>\n","      <td>4.085730</td>\n","    </tr>\n","    <tr>\n","      <td>40</td>\n","      <td>4.222300</td>\n","      <td>3.950263</td>\n","    </tr>\n","    <tr>\n","      <td>50</td>\n","      <td>3.879200</td>\n","      <td>3.778785</td>\n","    </tr>\n","    <tr>\n","      <td>60</td>\n","      <td>3.851600</td>\n","      <td>3.585327</td>\n","    </tr>\n","    <tr>\n","      <td>70</td>\n","      <td>3.495500</td>\n","      <td>3.354653</td>\n","    </tr>\n","    <tr>\n","      <td>80</td>\n","      <td>3.332300</td>\n","      <td>3.125087</td>\n","    </tr>\n","    <tr>\n","      <td>90</td>\n","      <td>3.142000</td>\n","      <td>2.920011</td>\n","    </tr>\n","    <tr>\n","      <td>100</td>\n","      <td>2.828100</td>\n","      <td>2.721506</td>\n","    </tr>\n","    <tr>\n","      <td>110</td>\n","      <td>2.757400</td>\n","      <td>2.612697</td>\n","    </tr>\n","    <tr>\n","      <td>120</td>\n","      <td>2.453300</td>\n","      <td>2.552350</td>\n","    </tr>\n","    <tr>\n","      <td>130</td>\n","      <td>2.568800</td>\n","      <td>2.525249</td>\n","    </tr>\n","    <tr>\n","      <td>140</td>\n","      <td>2.346300</td>\n","      <td>2.504189</td>\n","    </tr>\n","    <tr>\n","      <td>150</td>\n","      <td>2.385400</td>\n","      <td>2.492673</td>\n","    </tr>\n","    <tr>\n","      <td>160</td>\n","      <td>2.540100</td>\n","      <td>2.472691</td>\n","    </tr>\n","    <tr>\n","      <td>170</td>\n","      <td>2.408300</td>\n","      <td>2.457834</td>\n","    </tr>\n","    <tr>\n","      <td>180</td>\n","      <td>2.322500</td>\n","      <td>2.436928</td>\n","    </tr>\n","    <tr>\n","      <td>190</td>\n","      <td>2.198000</td>\n","      <td>2.420915</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>2.398500</td>\n","      <td>2.399089</td>\n","    </tr>\n","    <tr>\n","      <td>210</td>\n","      <td>2.319700</td>\n","      <td>2.382267</td>\n","    </tr>\n","    <tr>\n","      <td>220</td>\n","      <td>2.301800</td>\n","      <td>2.376485</td>\n","    </tr>\n","    <tr>\n","      <td>230</td>\n","      <td>2.217700</td>\n","      <td>2.361027</td>\n","    </tr>\n","    <tr>\n","      <td>240</td>\n","      <td>2.174700</td>\n","      <td>2.347270</td>\n","    </tr>\n","    <tr>\n","      <td>250</td>\n","      <td>2.217600</td>\n","      <td>2.339699</td>\n","    </tr>\n","    <tr>\n","      <td>260</td>\n","      <td>2.399000</td>\n","      <td>2.331346</td>\n","    </tr>\n","    <tr>\n","      <td>270</td>\n","      <td>2.255400</td>\n","      <td>2.337564</td>\n","    </tr>\n","    <tr>\n","      <td>280</td>\n","      <td>2.338300</td>\n","      <td>2.325161</td>\n","    </tr>\n","    <tr>\n","      <td>290</td>\n","      <td>2.441700</td>\n","      <td>2.321412</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>2.314900</td>\n","      <td>2.320782</td>\n","    </tr>\n","    <tr>\n","      <td>310</td>\n","      <td>2.152600</td>\n","      <td>2.315909</td>\n","    </tr>\n","    <tr>\n","      <td>320</td>\n","      <td>2.254900</td>\n","      <td>2.318610</td>\n","    </tr>\n","    <tr>\n","      <td>330</td>\n","      <td>2.331000</td>\n","      <td>2.315806</td>\n","    </tr>\n","    <tr>\n","      <td>340</td>\n","      <td>2.388600</td>\n","      <td>2.307966</td>\n","    </tr>\n","    <tr>\n","      <td>350</td>\n","      <td>2.338800</td>\n","      <td>2.305582</td>\n","    </tr>\n","    <tr>\n","      <td>360</td>\n","      <td>2.310800</td>\n","      <td>2.315704</td>\n","    </tr>\n","    <tr>\n","      <td>370</td>\n","      <td>2.148700</td>\n","      <td>2.335984</td>\n","    </tr>\n","    <tr>\n","      <td>380</td>\n","      <td>2.313200</td>\n","      <td>2.313705</td>\n","    </tr>\n","    <tr>\n","      <td>390</td>\n","      <td>2.332300</td>\n","      <td>2.305761</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>2.198800</td>\n","      <td>2.305964</td>\n","    </tr>\n","    <tr>\n","      <td>410</td>\n","      <td>2.405100</td>\n","      <td>2.301518</td>\n","    </tr>\n","    <tr>\n","      <td>420</td>\n","      <td>2.416300</td>\n","      <td>2.298127</td>\n","    </tr>\n","    <tr>\n","      <td>430</td>\n","      <td>2.183900</td>\n","      <td>2.302330</td>\n","    </tr>\n","    <tr>\n","      <td>440</td>\n","      <td>2.263100</td>\n","      <td>2.295013</td>\n","    </tr>\n","    <tr>\n","      <td>450</td>\n","      <td>2.168300</td>\n","      <td>2.299151</td>\n","    </tr>\n","    <tr>\n","      <td>460</td>\n","      <td>2.351300</td>\n","      <td>2.294308</td>\n","    </tr>\n","    <tr>\n","      <td>470</td>\n","      <td>2.267700</td>\n","      <td>2.306962</td>\n","    </tr>\n","    <tr>\n","      <td>480</td>\n","      <td>2.487400</td>\n","      <td>2.299831</td>\n","    </tr>\n","    <tr>\n","      <td>490</td>\n","      <td>2.247900</td>\n","      <td>2.292209</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>2.206000</td>\n","      <td>2.303916</td>\n","    </tr>\n","    <tr>\n","      <td>510</td>\n","      <td>2.123500</td>\n","      <td>2.292085</td>\n","    </tr>\n","    <tr>\n","      <td>520</td>\n","      <td>2.312600</td>\n","      <td>2.297571</td>\n","    </tr>\n","    <tr>\n","      <td>530</td>\n","      <td>2.380900</td>\n","      <td>2.288789</td>\n","    </tr>\n","    <tr>\n","      <td>540</td>\n","      <td>2.286100</td>\n","      <td>2.290699</td>\n","    </tr>\n","    <tr>\n","      <td>550</td>\n","      <td>2.246900</td>\n","      <td>2.291161</td>\n","    </tr>\n","    <tr>\n","      <td>560</td>\n","      <td>2.243000</td>\n","      <td>2.296249</td>\n","    </tr>\n","    <tr>\n","      <td>570</td>\n","      <td>2.257400</td>\n","      <td>2.283327</td>\n","    </tr>\n","    <tr>\n","      <td>580</td>\n","      <td>2.412500</td>\n","      <td>2.282415</td>\n","    </tr>\n","    <tr>\n","      <td>590</td>\n","      <td>2.290800</td>\n","      <td>2.282403</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>2.328700</td>\n","      <td>2.283388</td>\n","    </tr>\n","    <tr>\n","      <td>610</td>\n","      <td>2.269200</td>\n","      <td>2.289097</td>\n","    </tr>\n","    <tr>\n","      <td>620</td>\n","      <td>2.251900</td>\n","      <td>2.285473</td>\n","    </tr>\n","    <tr>\n","      <td>630</td>\n","      <td>2.242000</td>\n","      <td>2.287719</td>\n","    </tr>\n","    <tr>\n","      <td>640</td>\n","      <td>2.173800</td>\n","      <td>2.284493</td>\n","    </tr>\n","    <tr>\n","      <td>650</td>\n","      <td>1.962900</td>\n","      <td>2.284616</td>\n","    </tr>\n","    <tr>\n","      <td>660</td>\n","      <td>2.491700</td>\n","      <td>2.287962</td>\n","    </tr>\n","    <tr>\n","      <td>670</td>\n","      <td>2.343000</td>\n","      <td>2.283467</td>\n","    </tr>\n","    <tr>\n","      <td>680</td>\n","      <td>2.438200</td>\n","      <td>2.283079</td>\n","    </tr>\n","    <tr>\n","      <td>690</td>\n","      <td>2.442100</td>\n","      <td>2.285031</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>2.470100</td>\n","      <td>2.278650</td>\n","    </tr>\n","    <tr>\n","      <td>710</td>\n","      <td>2.370900</td>\n","      <td>2.280108</td>\n","    </tr>\n","    <tr>\n","      <td>720</td>\n","      <td>2.099100</td>\n","      <td>2.283525</td>\n","    </tr>\n","    <tr>\n","      <td>730</td>\n","      <td>2.299300</td>\n","      <td>2.281038</td>\n","    </tr>\n","    <tr>\n","      <td>740</td>\n","      <td>2.150500</td>\n","      <td>2.278866</td>\n","    </tr>\n","    <tr>\n","      <td>750</td>\n","      <td>2.096500</td>\n","      <td>2.280841</td>\n","    </tr>\n","    <tr>\n","      <td>760</td>\n","      <td>2.250200</td>\n","      <td>2.281575</td>\n","    </tr>\n","    <tr>\n","      <td>770</td>\n","      <td>2.148100</td>\n","      <td>2.283345</td>\n","    </tr>\n","    <tr>\n","      <td>780</td>\n","      <td>2.139000</td>\n","      <td>2.302220</td>\n","    </tr>\n","    <tr>\n","      <td>790</td>\n","      <td>2.195500</td>\n","      <td>2.281301</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>2.286500</td>\n","      <td>2.279225</td>\n","    </tr>\n","    <tr>\n","      <td>810</td>\n","      <td>2.268200</td>\n","      <td>2.278749</td>\n","    </tr>\n","    <tr>\n","      <td>820</td>\n","      <td>2.072900</td>\n","      <td>2.281204</td>\n","    </tr>\n","    <tr>\n","      <td>830</td>\n","      <td>2.362100</td>\n","      <td>2.291466</td>\n","    </tr>\n","    <tr>\n","      <td>840</td>\n","      <td>2.237100</td>\n","      <td>2.288200</td>\n","    </tr>\n","    <tr>\n","      <td>850</td>\n","      <td>2.222100</td>\n","      <td>2.276319</td>\n","    </tr>\n","    <tr>\n","      <td>860</td>\n","      <td>2.142600</td>\n","      <td>2.283985</td>\n","    </tr>\n","  </tbody>\n","</table><p>\n","    <div>\n","      \n","      <progress value='104' max='156' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [104/156 00:52 < 00:26, 1.95 it/s]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{},"output_type":"display_data"},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='1431' max='7044' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [1431/7044 3:30:45 < 13:47:49, 0.11 it/s, Epoch 0.41/2]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>10</td>\n","      <td>4.424000</td>\n","      <td>4.244807</td>\n","    </tr>\n","    <tr>\n","      <td>20</td>\n","      <td>4.359800</td>\n","      <td>4.178282</td>\n","    </tr>\n","    <tr>\n","      <td>30</td>\n","      <td>4.510600</td>\n","      <td>4.085730</td>\n","    </tr>\n","    <tr>\n","      <td>40</td>\n","      <td>4.222300</td>\n","      <td>3.950263</td>\n","    </tr>\n","    <tr>\n","      <td>50</td>\n","      <td>3.879200</td>\n","      <td>3.778785</td>\n","    </tr>\n","    <tr>\n","      <td>60</td>\n","      <td>3.851600</td>\n","      <td>3.585327</td>\n","    </tr>\n","    <tr>\n","      <td>70</td>\n","      <td>3.495500</td>\n","      <td>3.354653</td>\n","    </tr>\n","    <tr>\n","      <td>80</td>\n","      <td>3.332300</td>\n","      <td>3.125087</td>\n","    </tr>\n","    <tr>\n","      <td>90</td>\n","      <td>3.142000</td>\n","      <td>2.920011</td>\n","    </tr>\n","    <tr>\n","      <td>100</td>\n","      <td>2.828100</td>\n","      <td>2.721506</td>\n","    </tr>\n","    <tr>\n","      <td>110</td>\n","      <td>2.757400</td>\n","      <td>2.612697</td>\n","    </tr>\n","    <tr>\n","      <td>120</td>\n","      <td>2.453300</td>\n","      <td>2.552350</td>\n","    </tr>\n","    <tr>\n","      <td>130</td>\n","      <td>2.568800</td>\n","      <td>2.525249</td>\n","    </tr>\n","    <tr>\n","      <td>140</td>\n","      <td>2.346300</td>\n","      <td>2.504189</td>\n","    </tr>\n","    <tr>\n","      <td>150</td>\n","      <td>2.385400</td>\n","      <td>2.492673</td>\n","    </tr>\n","    <tr>\n","      <td>160</td>\n","      <td>2.540100</td>\n","      <td>2.472691</td>\n","    </tr>\n","    <tr>\n","      <td>170</td>\n","      <td>2.408300</td>\n","      <td>2.457834</td>\n","    </tr>\n","    <tr>\n","      <td>180</td>\n","      <td>2.322500</td>\n","      <td>2.436928</td>\n","    </tr>\n","    <tr>\n","      <td>190</td>\n","      <td>2.198000</td>\n","      <td>2.420915</td>\n","    </tr>\n","    <tr>\n","      <td>200</td>\n","      <td>2.398500</td>\n","      <td>2.399089</td>\n","    </tr>\n","    <tr>\n","      <td>210</td>\n","      <td>2.319700</td>\n","      <td>2.382267</td>\n","    </tr>\n","    <tr>\n","      <td>220</td>\n","      <td>2.301800</td>\n","      <td>2.376485</td>\n","    </tr>\n","    <tr>\n","      <td>230</td>\n","      <td>2.217700</td>\n","      <td>2.361027</td>\n","    </tr>\n","    <tr>\n","      <td>240</td>\n","      <td>2.174700</td>\n","      <td>2.347270</td>\n","    </tr>\n","    <tr>\n","      <td>250</td>\n","      <td>2.217600</td>\n","      <td>2.339699</td>\n","    </tr>\n","    <tr>\n","      <td>260</td>\n","      <td>2.399000</td>\n","      <td>2.331346</td>\n","    </tr>\n","    <tr>\n","      <td>270</td>\n","      <td>2.255400</td>\n","      <td>2.337564</td>\n","    </tr>\n","    <tr>\n","      <td>280</td>\n","      <td>2.338300</td>\n","      <td>2.325161</td>\n","    </tr>\n","    <tr>\n","      <td>290</td>\n","      <td>2.441700</td>\n","      <td>2.321412</td>\n","    </tr>\n","    <tr>\n","      <td>300</td>\n","      <td>2.314900</td>\n","      <td>2.320782</td>\n","    </tr>\n","    <tr>\n","      <td>310</td>\n","      <td>2.152600</td>\n","      <td>2.315909</td>\n","    </tr>\n","    <tr>\n","      <td>320</td>\n","      <td>2.254900</td>\n","      <td>2.318610</td>\n","    </tr>\n","    <tr>\n","      <td>330</td>\n","      <td>2.331000</td>\n","      <td>2.315806</td>\n","    </tr>\n","    <tr>\n","      <td>340</td>\n","      <td>2.388600</td>\n","      <td>2.307966</td>\n","    </tr>\n","    <tr>\n","      <td>350</td>\n","      <td>2.338800</td>\n","      <td>2.305582</td>\n","    </tr>\n","    <tr>\n","      <td>360</td>\n","      <td>2.310800</td>\n","      <td>2.315704</td>\n","    </tr>\n","    <tr>\n","      <td>370</td>\n","      <td>2.148700</td>\n","      <td>2.335984</td>\n","    </tr>\n","    <tr>\n","      <td>380</td>\n","      <td>2.313200</td>\n","      <td>2.313705</td>\n","    </tr>\n","    <tr>\n","      <td>390</td>\n","      <td>2.332300</td>\n","      <td>2.305761</td>\n","    </tr>\n","    <tr>\n","      <td>400</td>\n","      <td>2.198800</td>\n","      <td>2.305964</td>\n","    </tr>\n","    <tr>\n","      <td>410</td>\n","      <td>2.405100</td>\n","      <td>2.301518</td>\n","    </tr>\n","    <tr>\n","      <td>420</td>\n","      <td>2.416300</td>\n","      <td>2.298127</td>\n","    </tr>\n","    <tr>\n","      <td>430</td>\n","      <td>2.183900</td>\n","      <td>2.302330</td>\n","    </tr>\n","    <tr>\n","      <td>440</td>\n","      <td>2.263100</td>\n","      <td>2.295013</td>\n","    </tr>\n","    <tr>\n","      <td>450</td>\n","      <td>2.168300</td>\n","      <td>2.299151</td>\n","    </tr>\n","    <tr>\n","      <td>460</td>\n","      <td>2.351300</td>\n","      <td>2.294308</td>\n","    </tr>\n","    <tr>\n","      <td>470</td>\n","      <td>2.267700</td>\n","      <td>2.306962</td>\n","    </tr>\n","    <tr>\n","      <td>480</td>\n","      <td>2.487400</td>\n","      <td>2.299831</td>\n","    </tr>\n","    <tr>\n","      <td>490</td>\n","      <td>2.247900</td>\n","      <td>2.292209</td>\n","    </tr>\n","    <tr>\n","      <td>500</td>\n","      <td>2.206000</td>\n","      <td>2.303916</td>\n","    </tr>\n","    <tr>\n","      <td>510</td>\n","      <td>2.123500</td>\n","      <td>2.292085</td>\n","    </tr>\n","    <tr>\n","      <td>520</td>\n","      <td>2.312600</td>\n","      <td>2.297571</td>\n","    </tr>\n","    <tr>\n","      <td>530</td>\n","      <td>2.380900</td>\n","      <td>2.288789</td>\n","    </tr>\n","    <tr>\n","      <td>540</td>\n","      <td>2.286100</td>\n","      <td>2.290699</td>\n","    </tr>\n","    <tr>\n","      <td>550</td>\n","      <td>2.246900</td>\n","      <td>2.291161</td>\n","    </tr>\n","    <tr>\n","      <td>560</td>\n","      <td>2.243000</td>\n","      <td>2.296249</td>\n","    </tr>\n","    <tr>\n","      <td>570</td>\n","      <td>2.257400</td>\n","      <td>2.283327</td>\n","    </tr>\n","    <tr>\n","      <td>580</td>\n","      <td>2.412500</td>\n","      <td>2.282415</td>\n","    </tr>\n","    <tr>\n","      <td>590</td>\n","      <td>2.290800</td>\n","      <td>2.282403</td>\n","    </tr>\n","    <tr>\n","      <td>600</td>\n","      <td>2.328700</td>\n","      <td>2.283388</td>\n","    </tr>\n","    <tr>\n","      <td>610</td>\n","      <td>2.269200</td>\n","      <td>2.289097</td>\n","    </tr>\n","    <tr>\n","      <td>620</td>\n","      <td>2.251900</td>\n","      <td>2.285473</td>\n","    </tr>\n","    <tr>\n","      <td>630</td>\n","      <td>2.242000</td>\n","      <td>2.287719</td>\n","    </tr>\n","    <tr>\n","      <td>640</td>\n","      <td>2.173800</td>\n","      <td>2.284493</td>\n","    </tr>\n","    <tr>\n","      <td>650</td>\n","      <td>1.962900</td>\n","      <td>2.284616</td>\n","    </tr>\n","    <tr>\n","      <td>660</td>\n","      <td>2.491700</td>\n","      <td>2.287962</td>\n","    </tr>\n","    <tr>\n","      <td>670</td>\n","      <td>2.343000</td>\n","      <td>2.283467</td>\n","    </tr>\n","    <tr>\n","      <td>680</td>\n","      <td>2.438200</td>\n","      <td>2.283079</td>\n","    </tr>\n","    <tr>\n","      <td>690</td>\n","      <td>2.442100</td>\n","      <td>2.285031</td>\n","    </tr>\n","    <tr>\n","      <td>700</td>\n","      <td>2.470100</td>\n","      <td>2.278650</td>\n","    </tr>\n","    <tr>\n","      <td>710</td>\n","      <td>2.370900</td>\n","      <td>2.280108</td>\n","    </tr>\n","    <tr>\n","      <td>720</td>\n","      <td>2.099100</td>\n","      <td>2.283525</td>\n","    </tr>\n","    <tr>\n","      <td>730</td>\n","      <td>2.299300</td>\n","      <td>2.281038</td>\n","    </tr>\n","    <tr>\n","      <td>740</td>\n","      <td>2.150500</td>\n","      <td>2.278866</td>\n","    </tr>\n","    <tr>\n","      <td>750</td>\n","      <td>2.096500</td>\n","      <td>2.280841</td>\n","    </tr>\n","    <tr>\n","      <td>760</td>\n","      <td>2.250200</td>\n","      <td>2.281575</td>\n","    </tr>\n","    <tr>\n","      <td>770</td>\n","      <td>2.148100</td>\n","      <td>2.283345</td>\n","    </tr>\n","    <tr>\n","      <td>780</td>\n","      <td>2.139000</td>\n","      <td>2.302220</td>\n","    </tr>\n","    <tr>\n","      <td>790</td>\n","      <td>2.195500</td>\n","      <td>2.281301</td>\n","    </tr>\n","    <tr>\n","      <td>800</td>\n","      <td>2.286500</td>\n","      <td>2.279225</td>\n","    </tr>\n","    <tr>\n","      <td>810</td>\n","      <td>2.268200</td>\n","      <td>2.278749</td>\n","    </tr>\n","    <tr>\n","      <td>820</td>\n","      <td>2.072900</td>\n","      <td>2.281204</td>\n","    </tr>\n","    <tr>\n","      <td>830</td>\n","      <td>2.362100</td>\n","      <td>2.291466</td>\n","    </tr>\n","    <tr>\n","      <td>840</td>\n","      <td>2.237100</td>\n","      <td>2.288200</td>\n","    </tr>\n","    <tr>\n","      <td>850</td>\n","      <td>2.222100</td>\n","      <td>2.276319</td>\n","    </tr>\n","    <tr>\n","      <td>860</td>\n","      <td>2.142600</td>\n","      <td>2.283985</td>\n","    </tr>\n","    <tr>\n","      <td>870</td>\n","      <td>2.125100</td>\n","      <td>2.273980</td>\n","    </tr>\n","    <tr>\n","      <td>880</td>\n","      <td>2.269100</td>\n","      <td>2.273427</td>\n","    </tr>\n","    <tr>\n","      <td>890</td>\n","      <td>2.326700</td>\n","      <td>2.273912</td>\n","    </tr>\n","    <tr>\n","      <td>900</td>\n","      <td>2.228900</td>\n","      <td>2.273905</td>\n","    </tr>\n","    <tr>\n","      <td>910</td>\n","      <td>2.115400</td>\n","      <td>2.269496</td>\n","    </tr>\n","    <tr>\n","      <td>920</td>\n","      <td>2.220500</td>\n","      <td>2.280355</td>\n","    </tr>\n","    <tr>\n","      <td>930</td>\n","      <td>2.199900</td>\n","      <td>2.273546</td>\n","    </tr>\n","    <tr>\n","      <td>940</td>\n","      <td>2.118200</td>\n","      <td>2.275043</td>\n","    </tr>\n","    <tr>\n","      <td>950</td>\n","      <td>2.303400</td>\n","      <td>2.273342</td>\n","    </tr>\n","    <tr>\n","      <td>960</td>\n","      <td>2.235100</td>\n","      <td>2.283041</td>\n","    </tr>\n","    <tr>\n","      <td>970</td>\n","      <td>2.289400</td>\n","      <td>2.272212</td>\n","    </tr>\n","    <tr>\n","      <td>980</td>\n","      <td>2.162000</td>\n","      <td>2.270770</td>\n","    </tr>\n","    <tr>\n","      <td>990</td>\n","      <td>2.079000</td>\n","      <td>2.269680</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>2.348200</td>\n","      <td>2.265807</td>\n","    </tr>\n","    <tr>\n","      <td>1010</td>\n","      <td>2.347500</td>\n","      <td>2.266133</td>\n","    </tr>\n","    <tr>\n","      <td>1020</td>\n","      <td>2.082900</td>\n","      <td>2.276820</td>\n","    </tr>\n","    <tr>\n","      <td>1030</td>\n","      <td>2.371300</td>\n","      <td>2.269553</td>\n","    </tr>\n","    <tr>\n","      <td>1040</td>\n","      <td>2.228900</td>\n","      <td>2.264570</td>\n","    </tr>\n","    <tr>\n","      <td>1050</td>\n","      <td>2.316400</td>\n","      <td>2.261475</td>\n","    </tr>\n","    <tr>\n","      <td>1060</td>\n","      <td>2.023700</td>\n","      <td>2.270612</td>\n","    </tr>\n","    <tr>\n","      <td>1070</td>\n","      <td>2.272300</td>\n","      <td>2.262231</td>\n","    </tr>\n","    <tr>\n","      <td>1080</td>\n","      <td>2.137900</td>\n","      <td>2.263845</td>\n","    </tr>\n","    <tr>\n","      <td>1090</td>\n","      <td>2.177800</td>\n","      <td>2.265173</td>\n","    </tr>\n","    <tr>\n","      <td>1100</td>\n","      <td>2.069600</td>\n","      <td>2.277866</td>\n","    </tr>\n","    <tr>\n","      <td>1110</td>\n","      <td>2.196800</td>\n","      <td>2.271080</td>\n","    </tr>\n","    <tr>\n","      <td>1120</td>\n","      <td>2.113700</td>\n","      <td>2.266315</td>\n","    </tr>\n","    <tr>\n","      <td>1130</td>\n","      <td>2.127100</td>\n","      <td>2.267461</td>\n","    </tr>\n","    <tr>\n","      <td>1140</td>\n","      <td>2.132500</td>\n","      <td>2.262813</td>\n","    </tr>\n","    <tr>\n","      <td>1150</td>\n","      <td>2.041400</td>\n","      <td>2.262610</td>\n","    </tr>\n","    <tr>\n","      <td>1160</td>\n","      <td>2.162900</td>\n","      <td>2.264886</td>\n","    </tr>\n","    <tr>\n","      <td>1170</td>\n","      <td>2.072300</td>\n","      <td>2.261708</td>\n","    </tr>\n","    <tr>\n","      <td>1180</td>\n","      <td>2.325900</td>\n","      <td>2.265061</td>\n","    </tr>\n","    <tr>\n","      <td>1190</td>\n","      <td>2.382000</td>\n","      <td>2.261481</td>\n","    </tr>\n","    <tr>\n","      <td>1200</td>\n","      <td>2.147600</td>\n","      <td>2.257999</td>\n","    </tr>\n","    <tr>\n","      <td>1210</td>\n","      <td>2.498200</td>\n","      <td>2.258801</td>\n","    </tr>\n","    <tr>\n","      <td>1220</td>\n","      <td>2.074800</td>\n","      <td>2.260644</td>\n","    </tr>\n","    <tr>\n","      <td>1230</td>\n","      <td>2.170800</td>\n","      <td>2.259592</td>\n","    </tr>\n","    <tr>\n","      <td>1240</td>\n","      <td>2.224400</td>\n","      <td>2.259178</td>\n","    </tr>\n","    <tr>\n","      <td>1250</td>\n","      <td>2.191700</td>\n","      <td>2.260418</td>\n","    </tr>\n","    <tr>\n","      <td>1260</td>\n","      <td>2.100800</td>\n","      <td>2.262364</td>\n","    </tr>\n","    <tr>\n","      <td>1270</td>\n","      <td>2.250600</td>\n","      <td>2.255573</td>\n","    </tr>\n","    <tr>\n","      <td>1280</td>\n","      <td>2.141000</td>\n","      <td>2.255396</td>\n","    </tr>\n","    <tr>\n","      <td>1290</td>\n","      <td>2.159600</td>\n","      <td>2.263787</td>\n","    </tr>\n","    <tr>\n","      <td>1300</td>\n","      <td>2.223300</td>\n","      <td>2.267306</td>\n","    </tr>\n","    <tr>\n","      <td>1310</td>\n","      <td>2.104000</td>\n","      <td>2.267665</td>\n","    </tr>\n","    <tr>\n","      <td>1320</td>\n","      <td>2.248300</td>\n","      <td>2.255621</td>\n","    </tr>\n","    <tr>\n","      <td>1330</td>\n","      <td>2.118600</td>\n","      <td>2.256054</td>\n","    </tr>\n","    <tr>\n","      <td>1340</td>\n","      <td>2.211100</td>\n","      <td>2.256942</td>\n","    </tr>\n","    <tr>\n","      <td>1350</td>\n","      <td>2.211900</td>\n","      <td>2.256266</td>\n","    </tr>\n","    <tr>\n","      <td>1360</td>\n","      <td>1.968700</td>\n","      <td>2.254217</td>\n","    </tr>\n","    <tr>\n","      <td>1370</td>\n","      <td>2.099400</td>\n","      <td>2.254713</td>\n","    </tr>\n","    <tr>\n","      <td>1380</td>\n","      <td>2.305200</td>\n","      <td>2.252013</td>\n","    </tr>\n","    <tr>\n","      <td>1390</td>\n","      <td>2.322000</td>\n","      <td>2.252134</td>\n","    </tr>\n","    <tr>\n","      <td>1400</td>\n","      <td>2.278600</td>\n","      <td>2.250994</td>\n","    </tr>\n","    <tr>\n","      <td>1410</td>\n","      <td>2.269400</td>\n","      <td>2.255518</td>\n","    </tr>\n","    <tr>\n","      <td>1420</td>\n","      <td>1.996000</td>\n","      <td>2.257575</td>\n","    </tr>\n","  </tbody>\n","</table><p>\n","    <div>\n","      \n","      <progress value='156' max='156' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [156/156 01:20]\n","    </div>\n","    "]},"metadata":{}},{"output_type":"error","ename":"FailedPreconditionError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mFailedPreconditionError\u001b[0m                   Traceback (most recent call last)","\u001b[0;32m<ipython-input-25-73cd7c931103>\u001b[0m in \u001b[0;36m<cell line: 28>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     26\u001b[0m )\n\u001b[1;32m     27\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconfig\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muse_cache\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m  \u001b[0;31m# silence the warnings. Please re-enable for inference!\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 28\u001b[0;31m \u001b[0mtrainer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(self, resume_from_checkpoint, trial, ignore_keys_for_eval, **kwargs)\u001b[0m\n\u001b[1;32m   1530\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_inner_training_loop\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_train_batch_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mauto_find_batch_size\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1531\u001b[0m         )\n\u001b[0;32m-> 1532\u001b[0;31m         return inner_training_loop(\n\u001b[0m\u001b[1;32m   1533\u001b[0m             \u001b[0margs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1534\u001b[0m             \u001b[0mresume_from_checkpoint\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mresume_from_checkpoint\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36m_inner_training_loop\u001b[0;34m(self, batch_size, args, resume_from_checkpoint, trial, ignore_keys_for_eval)\u001b[0m\n\u001b[1;32m   1895\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallback_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_step_end\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1896\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1897\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_maybe_log_save_evaluate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtr_loss\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrial\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepoch\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mignore_keys_for_eval\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1898\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1899\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallback_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_substep_end\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36m_maybe_log_save_evaluate\u001b[0;34m(self, tr_loss, model, trial, epoch, ignore_keys_for_eval)\u001b[0m\n\u001b[1;32m   2220\u001b[0m                     \u001b[0mmetrics\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mupdate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdataset_metrics\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2221\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2222\u001b[0;31m                 \u001b[0mmetrics\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevaluate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mignore_keys\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mignore_keys_for_eval\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2223\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_report_to_hp_search\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrial\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mglobal_step\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmetrics\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2224\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mevaluate\u001b[0;34m(self, eval_dataset, ignore_keys, metric_key_prefix)\u001b[0m\n\u001b[1;32m   2954\u001b[0m         )\n\u001b[1;32m   2955\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2956\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlog\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmetrics\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2957\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2958\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mDebugOption\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTPU_METRICS_DEBUG\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mlog\u001b[0;34m(self, logs)\u001b[0m\n\u001b[1;32m   2562\u001b[0m         \u001b[0moutput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mlogs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;34m\"step\"\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mglobal_step\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2563\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlog_history\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2564\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallback_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_log\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlogs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2565\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2566\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_prepare_input\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mUnion\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mAny\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0mUnion\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mAny\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer_callback.py\u001b[0m in \u001b[0;36mon_log\u001b[0;34m(self, args, state, control, logs)\u001b[0m\n\u001b[1;32m    388\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mon_log\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mTrainingArguments\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mTrainerState\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcontrol\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mTrainerControl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlogs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    389\u001b[0m         \u001b[0mcontrol\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshould_log\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 390\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcall_event\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"on_log\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcontrol\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlogs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mlogs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    391\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    392\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mon_prediction_step\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mTrainingArguments\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mTrainerState\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcontrol\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mTrainerControl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer_callback.py\u001b[0m in \u001b[0;36mcall_event\u001b[0;34m(self, event, args, state, control, **kwargs)\u001b[0m\n\u001b[1;32m    395\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mcall_event\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mevent\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcontrol\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    396\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mcallback\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallbacks\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 397\u001b[0;31m             result = getattr(callback, event)(\n\u001b[0m\u001b[1;32m    398\u001b[0m                 \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    399\u001b[0m                 \u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/integrations.py\u001b[0m in \u001b[0;36mon_log\u001b[0;34m(self, args, state, control, logs, **kwargs)\u001b[0m\n\u001b[1;32m    649\u001b[0m                         \u001b[0;34m\"is incorrect so we dropped this attribute.\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    650\u001b[0m                     )\n\u001b[0;32m--> 651\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtb_writer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    652\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    653\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mon_train_end\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcontrol\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/utils/tensorboard/writer.py\u001b[0m in \u001b[0;36mflush\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1198\u001b[0m             \u001b[0;32mreturn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1199\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mwriter\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mall_writers\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1200\u001b[0;31m             \u001b[0mwriter\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1201\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1202\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/utils/tensorboard/writer.py\u001b[0m in \u001b[0;36mflush\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    148\u001b[0m         \u001b[0mdisk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    149\u001b[0m         \"\"\"\n\u001b[0;32m--> 150\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevent_writer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    151\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    152\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorboard/summary/writer/event_file_writer.py\u001b[0m in \u001b[0;36mflush\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    123\u001b[0m         \u001b[0mwritten\u001b[0m \u001b[0mto\u001b[0m \u001b[0mdisk\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    124\u001b[0m         \"\"\"\n\u001b[0;32m--> 125\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_async_writer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    126\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    127\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorboard/summary/writer/event_file_writer.py\u001b[0m in \u001b[0;36mflush\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    188\u001b[0m                 \u001b[0;32mraise\u001b[0m \u001b[0mIOError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Writer is closed\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    189\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_byte_queue\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 190\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_writer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    191\u001b[0m             \u001b[0;31m# Check the status again in case the background worker thread has\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    192\u001b[0m             \u001b[0;31m# failed in the meantime to avoid waiting until the next call to\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorboard/summary/writer/record_writer.py\u001b[0m in \u001b[0;36mflush\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m     41\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     42\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 43\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_writer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     44\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     45\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/tensorflow/python/lib/io/file_io.py\u001b[0m in \u001b[0;36mflush\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    219\u001b[0m     \"\"\"\n\u001b[1;32m    220\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_writable_file\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 221\u001b[0;31m       \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_writable_file\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflush\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    222\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    223\u001b[0m   \u001b[0;32mdef\u001b[0m \u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFailedPreconditionError\u001b[0m: /content/drive/MyDrive/쿠다 소설 생성/checkpoints_2/runs/Jul24_04-06-30_033853c48c71/events.out.tfevents.1690171590.033853c48c71.1153.2; Transport endpoint is not connected"]}]},{"cell_type":"markdown","source":["### 추론"],"metadata":{"id":"zaLjWb0oH_PN"}},{"cell_type":"code","source":["print(\"wow\")"],"metadata":{"id":"TvP11yUbhzWP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.eval()\n","model.config.use_cache = True  # silence the warnings. Please re-enable for inference!"],"metadata":{"id":"a-jauOEv9XVe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.generate(**tokenizer(\"### 질문:\\'다음 문장을 이어쓰시오.\", return_tensors='pt', return_token_type_ids=False))"],"metadata":{"id":"r4ITTiXfp-2r","executionInfo":{"status":"ok","timestamp":1690184485612,"user_tz":-540,"elapsed":1863,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"7dd49020-b953-4567-aba7-0c4e2e031404"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py:1270: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed soon, in a future version. Please use a generation configuration file (see https://huggingface.co/docs/transformers/main_classes/text_generation )\n","  warnings.warn(\n","Setting `pad_token_id` to `eos_token_id`:0 for open-end generation.\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py:1369: UserWarning: Using `max_length`'s default (20) to control the generation length. This behaviour is deprecated and will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/generation/utils.py:1468: UserWarning: You are calling .generate() with the `input_ids` being on a device type different than your model's device. `input_ids` is on cpu, whereas the model is on cuda. You may experience unexpected behaviors or slower generation. Please make sure that you have put `input_ids` to the correct device by calling for example input_ids = input_ids.to('cuda') before running `.generate()`.\n","  warnings.warn(\n"]},{"output_type":"execute_result","data":{"text/plain":["tensor([[   6,    6,    6, 2438,   29,   10, 4132, 7990,  276, 1350, 2778, 4892,\n","           17,  224,  202,  202,    6,    6,    6, 3284]])"]},"metadata":{},"execution_count":26}]},{"cell_type":"code","source":["def gen(x):\n","    gened = model.generate(\n","        **tokenizer(\n","            f\"### 질문: {x}\\n\\n### 맥락 : '멀리 떠났다. 느이 누나 말이다.' \\n\\n### 답변:\",\n","            return_tensors='pt',\n","            return_token_type_ids=False\n","        ),\n","        max_new_tokens=256,\n","        early_stopping=True,\n","        do_sample=True,\n","        eos_token_id=2,\n","    )\n","    print(tokenizer.decode(gened[0]))"],"metadata":{"id":"oDp9W-Gmp5Mb"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 몇 가지 팁\n","\n","- 만약 학습이 충분히 되지 않으면 `<|endoftext|>` 토큰이 잘 생성되지 않을 수 있습니다\n","- 이럴떈 충분히 긴 `max_new_tokens`를 준 뒤, `###`으로 잘라서 써보세요. ex) `output.split('###')[0]`\n","- 아래 결과는 실제 위 학습된(50step, 100개 샘플) 모델의 결과물입니다.\n","- 생성시에 속도가 꽤 느립니다. 1-2tokens/s 정도라 256토큰 생성시 약 ~3분 시간이 소요됩니다."],"metadata":{"id":"i_IDkurm8KyL"}},{"cell_type":"code","source":["gen('')"],"metadata":{"id":"iIbK1GaipZd9","executionInfo":{"status":"ok","timestamp":1690185489471,"user_tz":-540,"elapsed":118085,"user":{"displayName":"박민아","userId":"17348247684003147157"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"61fd599e-c05f-4bd0-b9e6-39d3d332ead0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.\n"]},{"output_type":"stream","name":"stdout","text":["### 질문: \n","\n","### 맥락 : '멀리 떠났다. 느이 누나 말이다.' \n","\n","### 답변:  하니, 소년이 울며 그리로 들어가거늘 한담은 그 어머니에게 왈,  하고 그 소년을 만류하려 하였다.  이렇게 말한 두 소년은 한담을 따라 한담의 집으로 들어갔다. 한담이 사랑에서 나와 한담이 집으로 들어가니 안으로부터 월선이가 눈물에 젖은 낯으로 뛰어나와 소리 높여 통곡하였다. 한담이 월선의 등을 쓰다듬으며 묻기를,    하니 월선이는 그제야 얼굴이 붉어지며 눈물을 씻었다.    월선은 그에게 있어서 소중한 사람이다. 그리고 그의 집에서 가장 귀한 사람이기도 했다. 한담은 그런 월선이가 울고 있으니 어찌 가보지 아니할 수가 있을까. 그래서 자신의 옷을 꿰매주고 한담은 월선의 집으로 달려갔다.    그 소리를 들은 월선은 반나절을 목놓아 울었으나 한담은 끝내 오지 아니했으므로 월선은 눈물을 거두고 머리 매무새를 바로 하였다.  한담은 하루를 더 묵었다가 가겠다는 이야기를 하고, 내일이면 또\n"]}]}]}